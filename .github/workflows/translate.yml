name: Translate Chinese Content

on:
  workflow_dispatch:  # 手动触发：Actions 页面点击 "Run workflow"

jobs:
  translate:
    runs-on: ubuntu-latest  # 使用 Ubuntu 环境

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4  # 拉取仓库代码

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.9'  # 使用 Python 3.9

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt  # 安装 opencc-python-reimplemented 等

    - name: Run converter script
      run: |
        # 翻译 input_file（这里用 requirements.txt 示例，你可以改成其他文件）
        python converter.py requirements.txt translated_output.txt
        # 输出翻译结果到 translated_output.txt

    - name: Show output (for verification)
      run: |
        echo "翻译完成！输出文件内容预览："
        cat translated_output.txt  # 在 Actions 日志中显示结果，便于检查

    - name: Commit translated file (optional)
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add translated_output.txt
        git diff --staged --quiet || git commit -m "Add translated output [skip ci]"
        git push
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # 自动 push 回主分支
